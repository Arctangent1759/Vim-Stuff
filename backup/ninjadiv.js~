$(function(){
	$('.ninja').each(function(){
		idle(this);
	})
})

function pitch(elem){

}

function yaw(elem){
	
}

function roll(elem){

}

function jump(elem,v0=1,g=.02){
	var t=0;
	var x=0;
	var y=0;
	var cb=function(){
		t=t+1;
		x=0;
		y=-(v0*t-.5*g*t*t);
		elem.setAttribute("style","left:"+x+"px;top:"+y+"px;");
		if (y==0){
			window.clearInterval(interval);
			idle(elem);
		}
	}
	var interval=window.setInterval(cb,0);

}

function wave(elem){
	
}

function circle(elem,radius=7){
	var t=0;
	var x=0;
	var y=0;
	var cb=function(){
		t=(t+4)%360;
		x=radius*Math.sin(t*Math.PI/180);
		y=radius*Math.cos(t*Math.PI/180)-radius;
		elem.setAttribute("style","left:"+x+"px;top:"+y+"px;");
		if (t==0){
			window.clearInterval(interval);
			idle(elem);
		}
	}
	var interval=window.setInterval(cb,0)
}

function hdhm(elem,a=15,p=100,f=.01,mt=300){
	var t=0;
	var x=0;
	var y=0;
	var cb=function(){
		t=t+1;
		x=(Math.pow(Math.E,-f*t))*a*Math.sin((2*Math.PI/p)*(t));
		y=0;
		elem.setAttribute("style","left:"+x+"px;top:"+y+"px;");
		if (t>=mt){
			elem.setAttribute("style","left:0px;top:0px;");
			window.clearInterval(interval);
			idle(elem);
		}
	}
	var interval=window.setInterval(cb,0)
}

function vdhm(elem,a=15,p=100,f=.01,mt=300){
	var t=0;
	var x=0;
	var y=0;
	var cb=function(){
		t=t+1;
		x=0;
		y=(Math.pow(Math.E,-f*t))*a*Math.sin((2*Math.PI/p)*(t));
		elem.setAttribute("style","left:"+x+"px;top:"+y+"px;");
		if (t>=mt){
			elem.setAttribute("style","left:0px;top:0px;");
			window.clearInterval(interval);
			idle(elem);
		}
	}
	var interval=window.setInterval(cb,0)
}

function bdhm(elem,a=15,p=100,f=.01,mt=300){
	var t=0;
	var x=0;
	var y=0;
	var cb=function(){
		t=t+1;
		x=(Math.pow(Math.E,-f*t))*a*Math.sin((2*Math.PI/p)*(t));
		y=(Math.pow(Math.E,-f*t))*a*Math.sin((2*Math.PI/p)*(t));
		elem.setAttribute("style","left:"+x+"px;top:"+y+"px;");
		if (t>=mt){
			elem.setAttribute("style","left:0px;top:0px;");
			window.clearInterval(interval);
			idle(elem);
		}
	}
	var interval=window.setInterval(cb,0)
}

var anims=[circle,jump,hdhm,vdhm,bdhm]
function idle(elem){
	var wait=Math.ceil(Math.random()*10000);
	var next_anim=anims[Math.floor(Math.random()*anims.length)];
	var cb=function(){
		next_anim(elem);
	}
	setTimeout(cb,wait);
}

//helpers
function randsign(){
	return Math.random()>.5? 1 : -1;
}
