% Search for all the places that say "PUT SOMETHING HERE".

\documentclass[11pt]{article}
\usepackage{amsmath,textcomp,amssymb,geometry,graphicx}

\def\Name{Alexander Chu}  % Your name
\def\Sec{107}  % Your GSI's name and discussion section
\def\Login{cs170-ix} % Your login
\def\Homework{2}%Number of Homework, PUT SOMETHING HERE
\def\Session{Fall 2013}


\title{CS170--Fall 2013 --- Solutions to Homework 2}
\author{\Name, section \Sec, \texttt{\Login}}
\markboth{CS170--\Session\  Homework \Homework\ \Name, section \Sec}{CS170--\Session\ Homework \Homework\ \Name, section \Sec, \texttt{\Login}}
\pagestyle{myheadings}

\begin{document}
\maketitle

\section*{Problem 1}
\label{pg:end-of-p1}


Let $X$ be a random variable denoting the number of flips before a head.\\
$P(X=n)=p(1-p)^{n-1}$\\
Let's compute the expected value of X.\\
$E[X=i]=\sum_{<i>}i*P(X=i)$\\
$E[X=i]=\sum_{i=1}^{\infty}ip(1-p)^{i-1}$\\
$E[X=i]=\sum_{i=1}^{\infty}ip(1-p)^{i-1}$\\
Let $q=1-p$\\
$E[X=i]=\sum_{i=1}^{\infty}iq^{k-1}(1-q)$\\
$E[X=i]=\sum_{i=1}^{\infty}iq^{k-1}-iq^{k}$\\
$E[X=i]=\sum_{i=0}^{\infty}(i+1)q^{k}-iq^{k}$\\
$E[X=i]=\sum_{i=0}^{\infty}q^{k}$\\
$E[X=i]=\frac{1}{1-q}=\frac{1}{p}$\\
If $p = \frac{1}{n}$,$E[X=i] = \frac{1}{p}=\frac{1}{\frac{1}{n}}=\boxed{n}$




% Make sure that the solution here does not exceed one page here. If
% it does, use the extra space for this problem at the end.  
%
% Comment out the next line if you are NOT using the extra space
\paragraph{} \emph{Continued on Page \pageref{pg:p1-continuation}}
\newpage


%%Do NOT remove/comment the next line
\pagestyle{plain}
%%It makes sure your name appears only on the first page
\section*{Problem 2}
\subsection*{Part (a)}

The maximal value of $q$, if $q$ is possibly $\sqrt{N}$, is $\frac{N}{2}$
Hence, we can limit the possibilities of q to members of the list of integers in $[1,\frac{N}{2}]$
With this constraint, we can perform binary search on $q$ to find $q|q^2=N$.
The algorithm is as follows:

\begin{verbatim}
function checkSquare(N):
    bottom=1
    top=N/2
    while (top > bottom):
        mid = floor((top + bottom) / 2)
        if (mid*mid == N):
        return True
        else if (mid > N):
            bottom=mid
        else:
            top=mid
    return False
\end{verbatim}

Since this algorithm executes a binary search (an $O(\log(n)$ algorithm because the size of the problem is halved with each iteration) over $\frac{N}{2}\in O(N)$ items, it executes a total of $O(\log(N))$ iterations.
Let $n$ be the number of bits in the input. $N \in O(2^n)$, so the number of iterations $\in O(log(2^n))=O(n)$.
The total bitwise cost of each iteration for the multiplication, the division, and the addition is $2n^2+n \in O(n^2)$.
Therefore, we do $O(n)$ iterations of a $O(n^2)$ operation, so our algorithm runs in $\boxed{O(n^3)}$.

\subsection*{Part (b)}

$N=q^k=2^{\log(q^k)}=2^{k\log{q}}$\\
$\Rightarrow \log{N}=\log(2^{k\log{q}})=k\log{q}$\\
$\Rightarrow k=\frac{\log{N}}{\log{q}}$\\
We are given $q>0, q \in \mathbb{Z}$, so $\log{q}\ge 1 \Rightarrow k=\frac{\log{N}}{\log{q}}\le \log{N}$.\\
So $\boxed{k\le \log{N}}$

\label{pg:end-of-p2}


% Make sure that the solution here does not exceed one page here. If
% it does, use the extra space for this problem at the end.  
%
% Comment out the next line if you are NOT using the extra space
\paragraph{} \emph{Continued on Page \pageref{pg:p2-continuation}}



\newpage

\section*{Problem 3}
\subsection*{Part (a)}
Suppose $a\neq 0,a=x^2$ (mod N).\\
$(-x)^2=(N-x)^2=N^2-2Nx+x^2=x^2=a$\\
So there are at least two values in ${0,\cdots,N-1}$ that satisfy $a=x^2$\\
But $x\times x = a$, so $x=ax^{-1}$. Since $x$ has only one inverse mod $N$, these two solutions are unique.
Hnce, $a=x^2$ has exactly solutions.
\subsection*{Part (b)}
If N is an odd prime, exactly two values in $[1,N-1]$ map to exactly one quadratic residue in $[1,N-1]$, a total of $\frac{N-1}{2}$.
What's left is $x=0$, which when squared, maps to $x^2=0$, the last quadratic residue, a total of $1$ residue.
Add the number of residues$\frac{N-1}{2}+1=\boxed{\frac{N+1}{2}}$.
\subsection*{Part (c)}
$\boxed{N=24,a=1,x=1,5,7}$

\label{pg:end-of-p3}

% Make sure that the solution here does not exceed one page here. If
% it does, use the extra space for this problem at the end.  
%
% Comment out the next line if you are NOT using the extra space
\paragraph{} \emph{Continued on Page \pageref{pg:p3-continuation}}




\newpage

\section*{Problem 4}

\subsection*{Part (a)}
If 5 and 7 do not divide a number, then 35 cannot divide that number.\\
$2013^{2014} = 3^{2014}=4^{1007}=4*1^{503}=4$ mod 5\\
$2012^{2013} = 2^{2013} = 2*4^{1006}=2*16^{503}=2$ mod 5\\
$2013^{2014}-2012^{2013}=2$ mod 5\\
Since 5 does not divide $2013^{2014}-2012^{2013}$, 35 does not divide it either. $\boxed{\mbox{No.}}$
\subsection*{Part (b)}
$2^{(170^70)}=2^{170^70 \mbox{mod 4}}$ mod 5\\
$2^{(170^70)}=2^{2^70 \mbox{mod 4}}$ mod 5\\
$2^{(170^70)}=2^{0}$ mod 5\\
$2^{(170^70)}=\boxed{1}$ mod 5

\label{pg:end-of-p4}

% Make sure that the solution here does not exceed one page here. If
% it does, use the extra space for this problem at the end.  
%
% Comment out the next line if you are NOT using the extra space
\paragraph{} \emph{Continued on Page \pageref{pg:p4-continuation}}


\newpage

\section*{Problem 5}
We know $e=3, N, and d$.\\
We also know $N=pq \Rightarrow q=\frac{N}{p}$, and that $e=d^{-1} \Rightarrow ed=1$ mod (p-1)(q-1).\\
Hence, $3d-1=k(p-1)(q-1)$ for some $k \in \mathbb{Z}$\\
Since $d$ is a number in mod (p-1)(q-1), $(p-1)(q-1)>d$\\
$3d-1=k(p-1)(q-1)<kd$\\
$k>\frac{3d-1}{d}=3-\frac{1}{d}<3$ since $d \in \mathbb{Z}^+$\\
So we only have to solve $3d-1=k(p-1)(N/p-1)$, or $p^2+k(N+1-3d)p+N=0$\\
We use the following algorithm:
\begin{verbatim}
    for k in [1:3]:
        sol=solveForp(3d-1=k(p-1)(N/p-1))
        if isInteger(sol):
            return sol
\end{verbatim}
Which, since solving a quadatic using the quadratic equation takes $O(n^2)$ time due to square and square root, runs in $O(n^2)$.



\label{pg:end-of-p5}

%Insert solution here


% Make sure that the solution here does not exceed one page here. If
% it does, use the extra space for this problem at the end.  
%
% Comment out the next line if you are NOT using the extra space
\paragraph{} \emph{Continued on Page \pageref{pg:p5-continuation}}


\newpage


\section*{Problem 6}

\subsection*{Part (a)}
Eve can intercept any message $M^e$ sent by Alice to Bob.\\
Hence, she can simply send the intercepted message $M^e$ to Bob for signing.\\
For the purposes of this problem, Bob is as dumb as a nail, and signing the message, returning $M^{ed}=M$ mod N, or the original message.\\
Eve now has the original message encrypted by Alice.\\
\subsection*{Part (b)}
Eve generates some random number $r<N$.\\
She then sends $r^eM^e$ to Bob for signing.\\
Bob signs the message, returning $r^{ed}M^{ed}=rM$ mod N to Bob.\\
To get the original message $M$, just multiply both sides by $r^{-1}$ mod N.\\
This cannot be done only if $r$ is not relatively prime to $N$, that is, $r=p$, or $r=q$.
Since $pq$ is a large number in most RSA schemes, our method satisfies the requirement that $M$ can be decrypted most of the time.



\label{pg:end-of-p6}

% Make sure that the solution here does not exceed one page here. If
% it does, use the extra space for this problem at the end.  
%
% Comment out the next line if you are NOT using the extra space
\paragraph{} \emph{Continued on Page \pageref{pg:p6-continuation}}


\newpage


%% Comment out the "extra spaces" completely for the problems for you
%% don't need them

\section*{Extra space for Problem 1}
%\emph{Continued from Page \pageref{pg:end-of-p1}}\\

%Insert solution here


%\label{pg:p1-continuation}
%\newpage
%%Comment out the above three lines if you are not using extra space
%%for this problem.


\section*{Extra space for Problem 2}
\emph{Continued from Page \pageref{pg:end-of-p2}}\\

\subsection*{Part (c)}

Try to verify that $q^k = N$ for each $(q,k)$ tuple in ${(q,k) | q in [1,\frac{n}{2}] \and k \in [1,log(N)]}$.
\begin{verbatim}
function checkPower(N):
    if N==1:
         return True
    for k in [1:log(N)]:
        bottom=1
        top=N/2
        while top > bottom
            q=floor((top+bottom)/2)
            pow = q^(k)
            if pow==N:
                return True
            else if pow > N:
                bottom=q
            else:
                top=q
    return False
\end{verbatim}
$log(N)\times log(N) \times n^3=\boxed{O(n^5)}$

\label{pg:p2-continuation}
\newpage
%%Comment out the above three lines if you are not using extra space
%%for this problem.


\section*{Extra space for Problem 3}
%\emph{Continued from Page \pageref{pg:end-of-p3}}\\

%Insert solution here

%\label{pg:p3-continuation}
%\newpage
%%Comment out the above three lines if you are not using extra space
%%for this problem.



\section*{Extra space for Problem 4}
%\emph{Continued from Page \pageref{pg:end-of-p4}}\\

%Insert solution here

%\label{pg:p4-continuation}
%\newpage
%%Comment out the above three lines if you are not using extra space
%%for this problem.



\section*{Extra space for Problem 5}
%\emph{Continued from Page \pageref{pg:end-of-p5}}\\

%Insert solution here


%\label{pg:p5-continuation}
%\newpage
%%Comment out the above three lines if you are not using extra space
%%for this problem.


\section*{Extra space for Problem 6}
%\emph{Continued from Page \pageref{pg:end-of-p6}}\\


%Insert solution here


%\label{pg:p6-continuation}
%\newpage
%%Comment out the above three lines if you are not using extra space
%%for this problem.



\end{document}
